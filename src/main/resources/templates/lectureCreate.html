<!--resources/templates/lectureCreate-->
<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>강좌 개설</title>
  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
</head>
<body>

<h2>강좌 개설 1단계 - 기본정보입력</h2>

<form id="lectureForm" th:action="@{/api/lectures}" method="post" enctype="multipart/form-data">
  <p><strong>작성자 :</strong>
    <span th:text="${username}"></span>
  </p>
  <div>
    <label for="category">카테고리선택</label>
    <select id="category" name="category" required>
      <option value="" disabled selected>카테고리 선택</option>
      <option value="외식">외식</option>
      <option value="서비스">서비스</option>
      <option value="사무직">사무직</option>
      <option value="기술">기술</option>
      <option value="운전">운전</option>
      <option value="디자인">디자인</option>
      <option value="IT">IT</option>
      <option value="생산">생산</option>
      <option value="교육">교육</option>
      <option value="의료">의료</option>
    </select>
  </div>

  <div>
    <label for="file">이미지 업로드</label>
    <input type="file" id="file" name="file">
  </div>
  <div>
    <label for="title">강좌 제목</label>
    <input type="text" id="title" name="title" required>
  </div>
  <div>
    <label for="content">강의소개</label>
    <textarea id="content" name="content" required></textarea>
  </div>
  <div>
    <label for="learning_target">학습대상</label>
    <textarea id="learning_target" name="learning_target" required></textarea>
  </div>
  <div>
    <label for="week">주</label>
    <input type="number" id="week" name="week" required>
  </div>
  <div>
    <label for="recruitEnd_date">모집마감날짜 : </label>
    <input type="datetime-local" id="recruitEnd_date" name="recruitEnd_date" required>
  </div>
    <label for="start_date">시작 날짜</label>
    <input type="datetime-local" id="start_date" name="start_date" required>
  </div>
  <div>
    <label for="end_date">종료 날짜</label>
    <input type="datetime-local" id="end_date" name="end_date" required>
  </div>

  <div>
    <label for="region">지역</label>
    <input type="text" id="region" name="region" required>
  </div>

  <div>
    <label for="max_participants">최대 참가자 수</label>
    <input type="number" id="max_participants" name="max_participants" required>
  </div>

  <div>
    <label for="price">가격</label>
    <input type="number" id="price" name="price" required>
  </div>

  <div>
    <label for="bank_name">은행 이름</label>
    <input type="text" id="bank_name" name="bank_name" required>
  </div>

  <div>
    <label for="account_name">계좌 이름</label>
    <input type="text" id="account_name" name="account_name" required>
  </div>

  <div>
    <label for="account_number">계좌 번호</label>
    <input type="text" id="account_number" name="account_number" required>
  </div>

  <br><br>
  <!-- 1단계 HTML -->
  <button type="button" id="nextStepButton">다음 단계로</button> <!-- style="display:none;" 부분을 제거 -->
</form>

<script>
document.getElementById('nextStepButton').addEventListener('click', async function(e) {
    e.preventDefault();

    const formData = new FormData(this);
    const lectureDto = {
        creator: this.creator.value,
        title: this.title.value,
        category: this.category.value,
        content: this.content.value,
        learning_target: this.learning_target.value,
        attendance_requirements: this.attendance_requirements,
        price: this.price.value,
        week: this.week.value,
        recruitEnd_date: this.recruitEnd_date.value,
        start_date: this.start_date.value,
        end_date: this.end_date.value,
        region: this.region.value,
        max_participants: this.max_participants.value,
        bank_name: this.bank_name.value,
        account_name: this.account_name.value,
        account_number: this.account_number.value,
    };

    formData.append('lectureDto', JSON.stringify(lectureDto));

    try {
        const response = await axios.post(this.action, formData, {
            headers: {
                'Content-Type': 'multipart/form-data',
            },
        });
        console.log(response.data);
        window.location.href = '/lecture/lectureList';
    } catch (error) {
        console.error('There was an error!', error);
    }
    window.location.href = '/lecture/lectureCreate2';
});
</script>

</body>
</html>
